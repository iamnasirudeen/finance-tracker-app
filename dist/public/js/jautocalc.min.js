"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

!function (e) {
  var t = {};

  function n(r) {
    if (t[r]) return t[r].exports;
    var o = t[r] = {
      i: r,
      l: !1,
      exports: {}
    };
    return e[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports;
  }

  n.m = e, n.c = t, n.d = function (e, t, r) {
    n.o(e, t) || Object.defineProperty(e, t, {
      enumerable: !0,
      get: r
    });
  }, n.r = function (e) {
    "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
      value: "Module"
    }), Object.defineProperty(e, "__esModule", {
      value: !0
    });
  }, n.t = function (e, t) {
    if (1 & t && (e = n(e)), 8 & t) return e;
    if (4 & t && "object" == (0, _typeof2["default"])(e) && e && e.__esModule) return e;
    var r = Object.create(null);
    if (n.r(r), Object.defineProperty(r, "default", {
      enumerable: !0,
      value: e
    }), 2 & t && "string" != typeof e) for (var o in e) {
      n.d(r, o, function (t) {
        return e[t];
      }.bind(null, o));
    }
    return r;
  }, n.n = function (e) {
    var t = e && e.__esModule ? function () {
      return e["default"];
    } : function () {
      return e;
    };
    return n.d(t, "a", t), t;
  }, n.o = function (e, t) {
    return Object.prototype.hasOwnProperty.call(e, t);
  }, n.p = "", n(n.s = 1);
}([function (e, t) {
  e.exports = jQuery;
}, function (e, t, n) {
  "use strict";

  n.r(t);
  var r = n(0),
      o = n.n(r);

  function s(e) {
    var t = [],
        n = /{([^}]+)}/gi;
    var r;

    for (; null != (r = n.exec(e));) {
      t.push(r[1]);
    }

    return t;
  }

  function c(e) {
    return /^[a-zA-Z].*/.test(e) ? ':input[name="' + e + '"]' : e;
  }

  function a(e, t, n) {
    var r = e + "",
        s = t.decimalOpts.concat(t.thousandOpts),
        c = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "-"];
    var a = "",
        u = "",
        i = "",
        f = -1,
        l = "",
        d = "",
        g = -1,
        p = 0;

    for (var _e = r.length - 1; _e >= 0; _e--) {
      u = r.charAt(_e), -1 != o.a.inArray(u, c) ? a = u + a : "" == i && -1 != o.a.inArray(u, t.decimalOpts) ? (f = _e, i = u, a = "." + a) : "" == l && -1 != o.a.inArray(u, t.thousandOpts) ? l = u : "" != d || -1 != o.a.inArray(u, s) || 0 != _e && _e != r.length - 1 || (d = u, g = _e);
    }

    return "" != i && (p = r.length - f - 1, g > f && p--), -1 != t.decimalPlaces && (p = t.decimalPlaces), 3 === arguments.length && ("" == n.dec && "" != i && (n.dec = i), (-1 == n.decPlaces && -1 != p || -1 != n.decPlaces && -1 != p && p < n.decPlaces) && (n.decPlaces = p), "" == n.thou && "" != l && (n.thou = l), "" == n.sym && "" != d && (n.sym = d, n.symLoc = g)), t.emptyAsZero && "" == a && (a = "0"), a;
  }

  var u = {
    "+": {
      op: "+",
      precedence: 10,
      assoc: "L",
      exec: function exec(e, t) {
        return e + t;
      }
    },
    "-": {
      op: "-",
      precedence: 10,
      assoc: "L",
      exec: function exec(e, t) {
        return e - t;
      }
    },
    "*": {
      op: "*",
      precedence: 20,
      assoc: "L",
      exec: function exec(e, t) {
        return e * t;
      }
    },
    "/": {
      op: "/",
      precedence: 20,
      assoc: "L",
      exec: function exec(e, t) {
        return e / t;
      }
    },
    "**": {
      op: "**",
      precedence: 30,
      assoc: "R",
      exec: function exec(e, t) {
        return Math.pow(e, t);
      }
    }
  },
      i = {
    e: Math.exp(1),
    pi: 4 * Math.atan2(1, 1)
  };

  function f(e) {
    var t = e.offset;
    var n, r;

    for (n = 0; "0123456789".indexOf(e.string.substr(e.offset, 1)) >= 0 && e.offset < e.string.length;) {
      e.offset++;
    }

    if ("." == e.string.substr(e.offset, 1)) for (e.offset++; "0123456789".indexOf(e.string.substr(e.offset, 1)) >= 0 && e.offset < e.string.length;) {
      e.offset++;
    }
    if (e.offset > t) return parseFloat(e.string.substr(t, e.offset - t));
    if ("+" == e.string.substr(e.offset, 1)) return e.offset++, f(e);
    if ("-" == e.string.substr(e.offset, 1)) return e.offset++, function (e) {
      return -e;
    }(f(e));

    if ("(" == e.string.substr(e.offset, 1)) {
      if (e.offset++, n = d(e), ")" == e.string.substr(e.offset, 1)) return e.offset++, n;
      throw e.error = "Parsing error: ')' expected", new Error("parseError");
    }

    if (null != (r = /^[a-z_][a-z0-9_]*/i.exec(e.string.substr(e.offset)))) {
      var _t = r[0];
      if (e.offset += _t.length, _t in i) return i[_t];
      throw e.error = "Semantic error: unknown variable '" + _t + "'", new Error("unknownVar");
    }

    throw e.string.length == e.offset ? (e.error = "Parsing error at end of string: value expected", new Error("valueMissing")) : (e.error = "Parsing error: unrecognized value", new Error("valueNotParsed"));
  }

  function l(e) {
    return "**" == e.string.substr(e.offset, 2) ? (e.offset += 2, u["**"]) : "+-*/".indexOf(e.string.substr(e.offset, 1)) >= 0 ? u[e.string.substr(e.offset++, 1)] : null;
  }

  function d(e) {
    var t = [{
      precedence: 0,
      assoc: "L"
    }];
    var n = f(e);

    for (;;) {
      var _r = l(e) || {
        precedence: 0,
        assoc: "L"
      };

      for (; _r.precedence < t[t.length - 1].precedence || _r.precedence == t[t.length - 1].precedence && "L" == _r.assoc;) {
        var _e2 = t.pop();

        if (!_e2.exec) return n;
        n = _e2.exec(_e2.value, n);
      }

      t.push({
        op: _r.op,
        precedence: _r.precedence,
        assoc: _r.assoc,
        exec: _r.exec,
        value: n
      }), n = f(e);
    }
  }

  function g(e, t, n, r, o, s, u) {
    var i = "";
    var f = {
      dec: "",
      decPlaces: -1,
      thou: "",
      sym: "",
      symLoc: -1
    };

    for (var _t2 in u) {
      var _n = u[_t2],
          _s = new RegExp(_n.rgx, "gi");

      var _c = void 0;

      for (; null != (_c = _s.exec(e));) {
        var _t3 = _n.exec(_c[1], r, o, f);

        e = e.replace(new RegExp(_n.rgx, "gi"), _t3);
      }
    }

    for (var _s2 = 0; _s2 < t.length; _s2++) {
      var _u = t[_s2],
          _i = a($(c(_u), r).val(), o, f);

      if (0 == _i.length) return void n.val("").change();
      e = e.replace(new RegExp("{" + _u + "}", "g"), _i);
    }

    e = e.replace(/ /g, ""), "" == f.dec && (f.dec = o.decimalOpts[0]), -1 == f.decPlaces && (f.decPlaces = 0), "" == f.thou && (f.thou = o.thousandOpts[0]);

    var l = function (e, t) {
      var n = {
        string: e,
        offset: 0
      };

      try {
        var _e3 = d(n);

        if (n.offset < n.string.length) throw n.error = "Syntax error: junk found at offset " + n.offset, new Error("trailingJunk");
        return _e3;
      } catch (e) {
        return t.showParseError && alert("".concat(n.error, " (").concat(e, "):\n").concat(n.string.substr(0, n.offset), "<*>").concat(n.string.substr(n.offset))), null;
      }
    }(e, o);

    i = (i = (i = (i = (i = null == l ? "" : function (e, t) {
      var n = (e.toFixed(t) + "").split("."),
          r = n.length > 1 ? "." + n[1] : "",
          o = /(\d+)(\d{3})/;
      var s = n[0];

      for (; o.test(s);) {
        s = s.replace(o, "$1,$2");
      }

      return s + r;
    }(l, f.decPlaces)).replace(/\./g, "<c>")).replace(/\,/g, "<t>")).replace(/<c>/g, f.dec)).replace(/<t>/g, f.thou), f.symLoc > -1 && (0 == f.symLoc ? i = f.sym + i : i += f.sym), o.smartIntegers && (i = i.replace(/[\,\.]0+$/, "")), $.isFunction(o.onShowResult) && (i = o.onShowResult.call(n, i)), n.val(i), o.chainFire && n.change();
  }

  var p = "jautocalc",
      h = "_" + p;
  var x = "focus change blur";

  function y(e, t, n, r) {
    return e.each(function () {
      var e = $(this);
      $("[" + t.attribute + "]:not([" + h + "])", e).each(function () {
        var o = $(this),
            a = o.attr(t.attribute),
            u = s(a);
        if (0 == u.length) return;

        for (var _t4 = 0; _t4 < u.length; _t4++) {
          if (0 == $(c(u[_t4]), e).length) return;
        }

        t.keyEventsFire && (x += " keyup keydown keypress");
        var i = x.split(" ").join("." + p + " ");

        for (var _s3 = 0; _s3 < u.length; _s3++) {
          var _f = u[_s3];
          $(c(_f), e).bind(i, {
            equation: a,
            equationFields: u,
            result: o,
            context: e,
            opts: t,
            vars: n,
            funcs: r
          }, function (e) {
            g(e.data.equation, e.data.equationFields, e.data.result, e.data.context, e.data.opts, e.data.vars, e.data.funcs);
          });
        }

        t.readOnlyResults && o.attr("readonly", "readonly"), o.attr(h, h), t.initFire && $(c(u[0]), e).change();
      });
    });
  }

  function m(e, t) {
    return e.each(function () {
      var e = $(this);
      $("[" + t.attribute + "][" + h + "]", e).each(function () {
        var n = $(this),
            r = s(n.attr(t.attribute));

        if (0 != r.length) {
          for (var _t5 = 0; _t5 < r.length; _t5++) {
            var _n2 = r[_t5];
            $(c(_n2), e).unbind("." + p);
          }

          t.readOnlyResults && n.removeAttr("readonly"), n.removeAttr(h);
        }
      });
    });
  }

  var b = {
    sum: {
      rgx: "sum\\({([^}]+)}\\)",
      exec: function exec(e, t, n, r) {
        var s = 0;
        return o()(c(e), t).each(function () {
          var e = parseFloat(a(o()(this).val(), n, r));
          s += e;
        }), s;
      }
    },
    avg: {
      rgx: "avg\\({([^}]+)}\\)",
      exec: function exec(e, t, n, r) {
        var s = 0;
        var u = o()(c(e), t).each(function () {
          var e = parseFloat(a(o()(this).val(), n, r));
          s += e;
        }).length;
        return s / u;
      }
    },
    min: {
      rgx: "min\\({([^}]+)}\\)",
      exec: function exec(e, t, n, r) {
        return Math.min.apply(this, o()(c(e), t).map(function (e, t) {
          return a(o()(t).val(), n, r);
        }).get());
      }
    },
    max: {
      rgx: "max\\({([^}]+)}\\)",
      exec: function exec(e, t, n, r) {
        return Math.max.apply(this, o()(c(e), t).map(function (e, t) {
          return a(o()(t).val(), n, r);
        }).get());
      }
    },
    count: {
      rgx: "count\\({([^}]+)}\\)",
      exec: function exec(e, t) {
        return o()(c(e), t).length;
      }
    },
    countNotEmpty: {
      rgx: "countNotEmpty\\({([^}]+)}\\)",
      exec: function exec(e, t) {
        return o.a.grep(o()(c(e), t), function (e) {
          return (o()(e).val() + "").length > 0;
        }).length;
      }
    }
  };
  o.a.fn.jAutoCalc = Object.assign(function () {
    var t = "init",
        n = o.a.extend({}, o.a.fn.jAutoCalc.defaults);
    var r = {
      init: y,
      destroy: m
    };

    for (var _len = arguments.length, e = new Array(_len), _key = 0; _key < _len; _key++) {
      e[_key] = arguments[_key];
    }

    for (var _i2 = 0, _e4 = e; _i2 < _e4.length; _i2++) {
      var _r2 = _e4[_i2];
      "string" == typeof _r2 && (t = _r2.toString()), "object" == (0, _typeof2["default"])(_r2) && (n = o.a.extend(n, _r2));
    }

    var s = o.a.extend({}, b, n.funcs),
        c = o.a.extend([], i, n.vars);
    return r[t] ? r[t](this, n, c, s) : y(this, n, c, s);
  }, {
    defaults: {
      attribute: "jAutoCalc",
      thousandOpts: [",", ".", " "],
      decimalOpts: [".", ","],
      decimalPlaces: -1,
      initFire: !0,
      chainFire: !0,
      keyEventsFire: !1,
      readOnlyResults: !0,
      showParseError: !0,
      emptyAsZero: !1,
      smartIntegers: !1,
      onShowResult: null,
      funcs: {},
      vars: {}
    }
  });
}]);